<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"> <!-- UTF-8 인코딩 지정 -->
    <title>Power Index Bubble Chart</title>
    <!-- Chart.js 라이브러리 추가 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- 여기에 그래프가 표시될 영역을 생성합니다 -->
    <canvas id="bubble-chart"></canvas>

    <script>
        // 데이터 샘플 (Python의 data 리스트와 비슷한 형태)
        var data = [
            {'country': '아프가니스탄', 'power': 0.014248, 'un2022_03': 'O'},
            {'country': '알바니아', 'power': 0.019427, 'un2022_03': 'O'},
            {'country': '안도라', 'power': 0.003533, 'un2022_03': 'O'},
            {'country': '아르헨티나', 'power': 0.617191, 'un2022_03': 'O'},
            {'country': '호주', 'power': 1.643869, 'un2022_03': 'O'},
            {'country': '오스트리아', 'power': 0.495986, 'un2022_03': 'O'},
            {'country': '앤티가 바부다', 'power': 0.001791, 'un2022_03': 'O'},
            {'country': '바하마', 'power': 0.013584, 'un2022_03': 'O'},
            {'country': '바레인', 'power': 0.043197, 'un2022_03': 'O'},
            {'country': '바베이도스', 'power': 0.005892, 'un2022_03': 'O'},
            {'country': '벨기에', 'power': 0.600969, 'un2022_03': 'O'},
            {'country': '벨리즈', 'power': 0.003042, 'un2022_03': 'O'},
            {'country': '베냉', 'power': 0.018522, 'un2022_03': 'O'},
            {'country': '부탄', 'power': 0.00258, 'un2022_03': 'O'},
            {'country': '보스니아', 'power': 0.027428, 'un2022_03': 'O'},
            {'country': '보츠와나', 'power': 0.01884, 'un2022_03': 'O'},
            {'country': '브라질', 'power': 2.003623, 'un2022_03': 'O'},
            {'country': '브루나이', 'power': 0.014932, 'un2022_03': 'O'},
            {'country': '불가리아', 'power': 0.096887, 'un2022_03': 'O'},
            {'country': '카보베르데', 'power': 0.002378, 'un2022_03': 'O'},
            {'country': '캄보디아', 'power': 0.029488, 'un2022_03': 'O'},
            {'country': '캐나다', 'power': 2.011738, 'un2022_03': 'O'},
            {'country': '차드', 'power': 0.011514, 'un2022_03': 'O'},
            {'country': '칠레', 'power': 0.345188, 'un2022_03': 'O'},
            {'country': '콜롬비아', 'power': 0.322208, 'un2022_03': 'O'},
            {'country': '코모로', 'power': 0.0013, 'un2022_03': 'O'},
            {'country': '코스타리카', 'power': 0.074879, 'un2022_03': 'O'},
            {'country': '코트디부아르', 'power': 0.067428, 'un2022_03': 'O'},
            {'country': '크로아티아', 'power': 0.075938, 'un2022_03': 'O'},
            {'country': '키프로스', 'power': 0.029709, 'un2022_03': 'O'},
            {'country': '체코', 'power': 0.318155, 'un2022_03': 'O'},
            {'country': '콩고민주공화국', 'power': 0.066879, 'un2022_03': 'O'},
            {'country': '덴마크', 'power': 0.390503, 'un2022_03': 'O'},
            {'country': '지부티', 'power': 0.003774, 'un2022_03': 'O'},
            {'country': '도미니카', 'power': 0.116767, 'un2022_03': 'O'},
            {'country': '에콰도르', 'power': 0.116767, 'un2022_03': 'O'},
            {'country': '이집트', 'power': 0.372673, 'un2022_03': 'O'},
            {'country': '에스토니아', 'power': 0.04, 'un2022_03': 'O'},
            {'country': '피지', 'power': 0.005189, 'un2022_03': 'O'},
            {'country': '핀란드', 'power': 0.29042, 'un2022_03': 'O'},
            {'country': '프랑스', 'power': 2.814462, 'un2022_03': 'O'},
            {'country': '감비아', 'power': 0.002195, 'un2022_03': 'O'},
            {'country': '조지아', 'power': 0.017935, 'un2022_03': 'O'},
            {'country': '독일', 'power': 4.148157, 'un2022_03': 'O'},
            {'country': '가나', 'power': 0.064135, 'un2022_03': 'O'},
            {'country': '그리스', 'power': 0.230376, 'un2022_03': 'O'},
            {'country': '과테말라', 'power': 0.098494, 'un2022_03': 'O'},
            {'country': '가이아나', 'power': 0.015702, 'un2022_03': 'O'},
            {'country': '아이티', 'power': 0.025589, 'un2022_03': 'O'},
            {'country': '온두라스', 'power': 0.033059, 'un2022_03': 'O'},
            {'country': '헝가리', 'power': 0.18148, 'un2022_03': 'O'},
            {'country': '아이슬란드', 'power': 0.027562, 'un2022_03': 'O'},
            {'country': '인도네시아', 'power': 1.339875, 'un2022_03': 'O'},
            {'country': '이라크', 'power': 0.257899, 'un2022_03': 'O'},
            {'country': '아일랜드', 'power': 0.571944, 'un2022_03': 'O'},
            {'country': '이스라엘', 'power': 0.51911, 'un2022_03': 'O'},
            {'country': '이탈리아', 'power': 2.088832, 'un2022_03': 'O'},
            {'country': '자메이카', 'power': 0.016607, 'un2022_03': 'O'},
            {'country': '일본', 'power': 4.245284, 'un2022_03': 'O'},
            {'country': '요르단', 'power': 0.050118, 'un2022_03': 'O'},
            {'country': '케냐', 'power': 0.113724, 'un2022_03': 'O'},
            {'country': '키리바시', 'power': 0.000241, 'un2022_03': 'O'},
            {'country': '쿠웨이트', 'power': 0.158567, 'un2022_03': 'O'},
            {'country': '라트비아', 'power': 0.045632, 'un2022_03': 'O'},
            {'country': '레소토', 'power': 0.002484, 'un2022_03': 'O'},
            {'country': '라이베리아', 'power': 0.004217, 'un2022_03': 'O'},
            {'country': '리비아', 'power': 0.044573, 'un2022_03': 'O'},
            {'country': '리히텐슈타인', 'power': 0.005882, 'un2022_03': 'O'},
            {'country': '리투아니아', 'power': 0.075428, 'un2022_03': 'O'},
            {'country': '룩셈부르크', 'power': 0.083727, 'un2022_03': 'O'},
            {'country': '마다가스카르', 'power': 0.015374, 'un2022_03': 'O'},
            {'country': '말라위', 'power': 0.010859, 'un2022_03': 'O'},
            {'country': '말레이시아', 'power': 0.430359, 'un2022_03': 'O'},
            {'country': '몰디브', 'power': 0.006739, 'un2022_03': 'O'},
            {'country': '몰타', 'power': 0.018686, 'un2022_03': 'O'},
            {'country': '마셜제도', 'power': 0.000279, 'un2022_03': 'O'},
            {'country': '모리타니', 'power': 0.010561, 'un2022_03': 'O'},
            {'country': '모리셔스', 'power': 0.014027, 'un2022_03': 'O'},
            {'country': '멕시코', 'power': 1.601135, 'un2022_03': 'O'},
            {'country': '미크로네시아', 'power': 0.000443, 'un2022_03': 'O'},
            {'country': '모나코', 'power': 0.008279, 'un2022_03': 'O'},
            {'country': '몬테네그로', 'power': 0.006768, 'un2022_03': 'O'},
            {'country': '모로코', 'power': 0.133604, 'un2022_03': 'O'},
            {'country': '미얀마', 'power': 0.061604, 'un2022_03': 'O'},
            {'country': '나우루', 'power': 0.000144, 'un2022_03': 'O'},
            {'country': '네팔', 'power': 0.04053, 'un2022_03': 'O'},
            {'country': '네덜란드', 'power': 1.04057, 'un2022_03': 'O'},
            {'country': '뉴질랜드', 'power': 0.242573, 'un2022_03': 'O'},
            {'country': '니제르', 'power': 0.016, 'un2022_03': 'O'},
            {'country': '나이지리아', 'power': 0.487707, 'un2022_03': 'O'},
            {'country': '북마케도니아', 'power': 0.01471, 'un2022_03': 'O'},
            {'country': '노르웨이', 'power': 0.533445, 'un2022_03': 'O'},
            {'country': '오만', 'power': 0.100988, 'un2022_03': 'O'},
            {'country': '팔라우', 'power': 0.00025, 'un2022_03': 'O'},
            {'country': '파나마', 'power': 0.074379, 'un2022_03': 'O'},
            {'country': '파푸아뉴기니', 'power': 0.031635, 'un2022_03': 'O'},
            {'country': '파라과이', 'power': 0.041223, 'un2022_03': 'O'},
            {'country': '페루', 'power': 0.258236, 'un2022_03': 'O'},
            {'country': '필리핀', 'power': 0.424457, 'un2022_03': 'O'},
            {'country': '폴란드', 'power': 0.720961, 'un2022_03': 'O'},
            {'country': '포르투갈', 'power': 0.257736, 'un2022_03': 'O'},
            {'country': '카타르', 'power': 0.211381, 'un2022_03': 'O'},
            {'country': '대한민국', 'power': 2.317694, 'un2022_03': 'O'},
            {'country': '몰도바', 'power': 0.01524, 'un2022_03': 'O'},
            {'country': '루마니아', 'power': 0.335888, 'un2022_03': 'O'},
            {'country': '르완다', 'power': 0.01266, 'un2022_03': 'O'},
            {'country': '세인트 키츠 네비스', 'power': 0.00102, 'un2022_03': 'O'},
            {'country': '세인트 루시아', 'power': 0.002176, 'un2022_03': 'O'},
            {'country': '세인트 빈센트 그레나딘', 'power': 0.001001, 'un2022_03': 'O'},
            {'country': '사모아', 'power': 0.000866, 'un2022_03': 'O'},
            {'country': '산마리노', 'power': 0.001742, 'un2022_03': 'O'},
            {'country': '상투메', 'power': 0.000607, 'un2022_03': 'O'},
            {'country': '사우디아라비아', 'power': 1.022298, 'un2022_03': 'O'},
            {'country': '세르비아', 'power': 0.071202, 'un2022_03': 'O'},
            {'country': '세이셸', 'power': 0.001877, 'un2022_03': 'O'},
            {'country': '시에라리온', 'power': 0.003389, 'un2022_03': 'O'},
            {'country': '싱가포르', 'power': 0.496323, 'un2022_03': 'O'},
            {'country': '슬로바키아', 'power': 0.122774, 'un2022_03': 'O'},
            {'country': '슬로베니아', 'power': 0.06557, 'un2022_03': 'O'},
            {'country': '솔로몬 제도', 'power': 0.001637, 'un2022_03': 'O'},
            {'country': '소말리아', 'power': 0.008414, 'un2022_03': 'O'},
            {'country': '남수단', 'power': 0.006749, 'un2022_03': 'O'},
            {'country': '스페인', 'power': 1.436772, 'un2022_03': 'O'},
            {'country': '수리남', 'power': 0.003341, 'un2022_03': 'O'},
            {'country': '스웨덴', 'power': 0.576709, 'un2022_03': 'O'},
            {'country': '스위스', 'power': 0.837169, 'un2022_03': 'O'},
            {'country': '태국', 'power': 0.552815, 'un2022_03': 'O'},
            {'country': '동티모르', 'power': 0.001916, 'un2022_03': 'O'},
            {'country': '통가', 'power': 0.00052, 'un2022_03': 'O'},
            {'country': '트리니다드 토바고', 'power': 0.027168, 'un2022_03': 'O'},
            {'country': '튀니지', 'power': 0.047962, 'un2022_03': 'O'},
            {'country': '투발루', 'power': 6.7e-05, 'un2022_03': 'O'},
            {'country': '튀르키에', 'power': 0.990914, 'un2022_03': 'O'},
            {'country': '우크라이나', 'power': 0.143164, 'un2022_03': 'O'},
            {'country': '아랍에미리트', 'power': 0.480371, 'un2022_03': 'O'},
            {'country': '영국', 'power': 3.041131, 'un2022_03': 'O'},
            {'country': '미국', 'power': 25.853093, 'un2022_03': 'O'},
            {'country': '우루과이', 'power': 0.074427, 'un2022_03': 'O'},
            {'country': '바누아투', 'power': 0.00102, 'un2022_03': 'O'},
            {'country': '예멘', 'power': 0.018802, 'un2022_03': 'O'},
            {'country': '잠비아', 'power': 0.028178, 'un2022_03': 'O'},
            {'country': '벨라루스', 'power': 0.070797, 'un2022_03': 'X'},
            {'country': '북한', 'power': 0.002647, 'un2022_03': 'X'},
            {'country': '에리트레아', 'power': 0.00257, 'un2022_03': 'X'},
            {'country': '말리', 'power': 0.020005, 'un2022_03': 'J'},
            {'country': '니카리과', 'power': 0.016645, 'un2022_03': 'J'},
            {'country': '러시아', 'power': 1.985726, 'un2022_03': 'X'},
            {'country': '시리아', 'power': 0.010667, 'un2022_03': 'X'},
            {'country': '알제리', 'power': 0.198327, 'un2022_03': 'J'},
            {'country': '앙골라', 'power': 0.113484, 'un2022_03': 'J'},
            {'country': '아르메니아', 'power': 0.022845, 'un2022_03': 'J'},
            {'country': '방글라데시', 'power': 0.404837, 'un2022_03': 'J'},
            {'country': '볼리비아', 'power': 0.044381, 'un2022_03': 'J'},
            {'country': '부룬디', 'power': 0.00311, 'un2022_03': 'J'},
            {'country': '중앙아프리카 공화국', 'power': 0.002638, 'un2022_03': 'J'},
            {'country': '중국', 'power': 18.651077, 'un2022_03': 'J'},
            {'country': '콩고공화국', 'power': 0.012544, 'un2022_03': 'J'},
            {'country': '쿠바', 'power': 0.103395, 'un2022_03': 'J'},
            {'country': '엘살바도르', 'power': 0.032491, 'un2022_03': 'J'},
            {'country': '에티오피아', 'power': 0.150259, 'un2022_03': 'J'},
            {'country': '가봉', 'power': 0.019572, 'un2022_03': 'J'},
            {'country': '기니', 'power': 0.022431, 'un2022_03': 'J'},
            {'country': '인도', 'power': 3.597518, 'un2022_03': 'J'},
            {'country': '이란', 'power': 0.354247, 'un2022_03': 'J'},
            {'country': '카자흐스탄', 'power': 0.236537, 'un2022_03': 'J'},
            {'country': '키르기스스탄', 'power': 0.008222, 'un2022_03': 'J'},
            {'country': '라오스', 'power': 0.013565, 'un2022_03': 'J'},
            {'country': '몽골', 'power': 0.016279, 'un2022_03': 'J'},
            {'country': '모잠비크', 'power': 0.019167, 'un2022_03': 'J'},
            {'country': '나미비아', 'power': 0.012987, 'un2022_03': 'J'},
            {'country': '파키스탄', 'power': 0.335311, 'un2022_03': 'J'},
            {'country': '남아프리카', 'power': 0.384139, 'un2022_03': 'J'},
            {'country': '스리랑카', 'power': 0.085613, 'un2022_03': 'J'},
            {'country': '수단', 'power': 0.044968, 'un2022_03': 'J'},
            {'country': '타지키스탄', 'power': 0.012323, 'un2022_03': 'J'},
            {'country': '토고', 'power': 0.008664, 'un2022_03': 'J'},
            {'country': '우간다', 'power': 0.047933, 'un2022_03': 'J'},
            {'country': '우즈베키스탄', 'power': 0.088887, 'un2022_03': 'J'},
            {'country': '베트남', 'power': 0.432342, 'un2022_03': 'J'},
            {'country': '짐바브웨', 'power': 0.028814, 'un2022_03': 'J'}
        ];

        // 'un2022_03' 값에 따라 그룹을 나누기 위한 인덱스 딕셔너리
        var group_indices = {'X': 1, 'J': 2, 'O': 3};

        // 그래프를 그리는 함수
        function drawBubbleChart() {
            // Initialize empty arrays for each group type
            var x_values_x = [];
            var y_values_x = [];
            var size_values_x = [];
            var labels_x = [];
            var countries_x = [];

            var x_values_j = [];
            var y_values_j = [];
            var size_values_j = [];
            var labels_j = [];
            var countries_j = [];

            var x_values_o = [];
            var y_values_o = [];
            var size_values_o = [];
            var labels_o = [];
            var countries_o = [];

            // Separate data based on 'un2022_03' value
            for (var i = 0; i < data.length; i++) {
                var item = data[i];
                if (item['un2022_03'] == 'X') {
                    x_values_x.push(group_indices[item['un2022_03']] + Math.random() * 0.18 - 0.09);
                    y_values_x.push(Math.random() * 2 - 1);
                    size_values_x.push(item['power']);
                    labels_x.push(item['country']);
                    countries_x.push(item['country']); // 국가 이름 배열에 추가
                } else if (item['un2022_03'] == 'J') {
                    x_values_j.push(group_indices[item['un2022_03']] + Math.random() * 0.18 - 0.09);
                    y_values_j.push(Math.random() * 2 - 1);
                    size_values_j.push(item['power']);
                    labels_j.push(item['country']);
                    countries_j.push(item['country']); // 국가 이름 배열에 추가
                } else {
                    x_values_o.push(group_indices[item['un2022_03']] + Math.random() * 0.18 - 0.09);
                    y_values_o.push(Math.random() * 2 - 1);
                    size_values_o.push(item['power']);
                    labels_o.push(item['country']);
                    countries_o.push(item['country']); // 국가 이름 배열에 추가
                }
            }

            // Normalize size_values within each group to the range [0.6, 1.0]
            var max_size_x = Math.max(...size_values_x);
            var min_size_x = Math.min(...size_values_x);
            var normalized_size_x = size_values_x.map(size => (size - min_size_x) / (max_size_x - min_size_x) * 0.8 + 0.5);

            var max_size_j = Math.max(...size_values_j);
            var min_size_j = Math.min(...size_values_j);
            var normalized_size_j = size_values_j.map(size => (size - min_size_j) / (max_size_j - min_size_j) * 0.8 + 0.5);

            var max_size_o = Math.max(...size_values_o);
            var min_size_o = Math.min(...size_values_o);
            var normalized_size_o = size_values_o.map(size => (size - min_size_o) / (max_size_o - min_size_o) * 0.8 + 0.5);

            // 버블 차트 데이터
            var chartData = {
                datasets: [
                    {
                        label: 'X',
                        data: x_values_x.map((x, i) => ({ x, y: y_values_x[i], r: normalized_size_x[i] * 50 })),
                        backgroundColor: 'rgba(255, 99, 132, 0.7)',
                        labels: countries_x // 국가 이름 배열 추가
                    },
                    {
                        label: 'J',
                        data: x_values_j.map((x, i) => ({ x, y: y_values_j[i], r: normalized_size_j[i] * 50 })),
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        labels: countries_j // 국가 이름 배열 추가
                    },
                    {
                        label: 'O',
                        data: x_values_o.map((x, i) => ({ x, y: y_values_o[i], r: normalized_size_o[i] * 50 })),
                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                        labels: countries_o // 국가 이름 배열 추가
                    },
                ],
            };

            // 차트 옵션
            var chartOptions = {
                responsive: true,
                title: {
                    display: true,
                    text: 'Power Index Bubble Chart',
                },
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        ticks: {
                            stepSize: 1,
                            callback: function(value, index, values) {
                                return ['X', 'J', 'O'][index];
                            }
                        }
                    },
                    y: {
                        ticks: {
                            callback: function(value, index, values) {
                                return '';
                            }
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.labels[context.dataIndex] + ': ' + context.dataset.data[context.dataIndex].r;
                            }
                        }
                    }
                }
            };

            // 차트 생성
            var bubbleChart = new Chart('bubble-chart', {
                type: 'bubble',
                data: chartData,
                options: chartOptions
            });
        }
        // 그래프 그리기 함수 호출
        drawBubbleChart();
    </script>
</body>
</html>